<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Embedding Schematron in XML Schema Documents, 1.0alpha2</title><style type="text/css" media="all">body { font-family: "Times New Roman", Times, serif; background-color: #FFF; color: #000; margin: 3em; } p.todo { color: #000; background-color: #FCC; } a { text-decoration: none; color: #000; background-color: #FFF; } span.issue, span.issue a { color: #000; background-color: #FCC; } a[href]:hover { color: #000; background-color: #F9FAD4; } a.url { font-family: "Courier New", Courier, monospace; font-size: 80%; } a.ref, span.ref { font-weight: bold; } span.termRef::before { content: "·"; } span.termRef::after { content: "·"; } div.img { width: 100%; text-align: center; } img { width: 100%; } div.table { } div.table > table { margin: auto; } div.title { font-size: 200%; font-weight: bold; margin: 1em 5em; text-align: center; } div.subtitle { font-size: 150%; font-weight: bold; margin: 1em 5em; text-align: center; } div.heading { font-size: 125%; font-weight: bold; margin-top: 1em; margin-bottom: 1em; page-break-after: avoid; page-break-inside: avoid; } div.rule-section > div.heading { font-size: 100%; } div.section, div.rule-section { margin-left: 2em; } div.section div.section { margin-left: 0; } div.section div.heading { margin-left: -2em; } div.meta { width: 33%; float: right; clear: right; } div.meta > p { padding: 0; margin: 0; } div.box, div.meta { background-color: #EEE; color: #000; border: solid black 1px; padding: 1.0em; } div.box a, div.meta a { background-color: #EEE; color: #000; } div.box a:hover, div.meta a:hover { background-color: #F9FAD4; color: #000; } div.box + div.box, div.figure + div.box { margin-top: 1em; } div.normativeHead { font-weight: bold; margin-bottom: 1em; } dfn { font-style: normal; } div.sub { margin-left: 2em; } div.sub > *:last-child { margin-bottom: 0; } td,th { border: solid black 1px; } th { color: #000; background-color: #EEE; } table { border-collapse: collapse; } code { font-family: "Courier New", Courier, monospace; font-size: 80%; } pre { font-family: "Courier New", Courier, monospace; font-size: 80%; white-space: pre-wrap; margin: 0; } div.caption { font-weight: bold; text-align: center; page-break-after: avoid; page-break-inside: avoid; } p.hang { text-indent: -2em; margin-left: 2em; } q { quotes: '\201C' '\201D' '\2018' '\2019'; } q:before { content: open-quote; } q:after { content: close-quote; } ol ol > li { list-style-type: upper-alpha; }</style></head><body><div class="title">Embedding Schematron in XML Schema Documents</div><div class="subtitle">Version 1.0alpha2</div><div class="subtitle">February 4, 2014</div><div class="subtitle">Webb Roberts &lt;<a class="url" target="_blank" href="mailto:webb.roberts@gtri.gatech.edu">webb.roberts@gtri.gatech.edu</a>&gt;</div><div class="section"><div class="heading"><a name="d3e21"></a>Table of Contents</div><ul><li><a href="#section_1">1. Introduction</a></li><li><a href="#section_2">2. Problems and approaches</a><ul><li><a href="#section_2.1">2.1. Processing requirements</a></li><li><a href="#section_2.2">2.2. There is no definition of a basic or schema-aware XPath processor</a></li><li><a href="#section_2.3">2.3. Target Schematron processors vary</a></li><li><a href="#section_2.4">2.4. XML Schema has many features</a></li><li><a href="#section_2.5">2.5. Applying Schematron Rules to a schema component can be complex</a></li><li><a href="#section_2.6">2.6. Schematron namespace declarations are redundant to XML namespace declarations</a></li></ul></li><li><a href="#section_3">3. Namespace prefixes used in this document</a></li><li><a href="#section_4">4. Terminology established by references </a><ul><li><a href="#section_4.1">4.1. RFC 2119</a></li><li><a href="#section_4.2">4.2. XML</a></li><li><a href="#section_4.3">4.3. XML Information Set</a></li><li><a href="#section_4.4">4.4. XML Schema</a></li><li><a href="#section_4.5">4.5. XPath</a></li><li><a href="#section_4.6">4.6. XSLT 2.0</a></li><li><a href="#section_4.7">4.7. XSLT 1.0</a></li><li><a href="#section_4.8">4.8. Schematron</a></li><li><a href="#section_4.9">4.9. NIEM Conformance Target Attribute Specification</a></li><li><a href="#section_4.10">4.10. NIEM Naming and Design Rules</a></li></ul></li><li><a href="#section_5">5. Terms and Definitions</a></li><li><a href="#section_6">6. Rules</a><ul><li><a href="#section_6.1">6.1. Schematron throughout the document</a></li><li><a href="#section_6.2">6.2. Top-level attribute declaration</a></li><li><a href="#section_6.3">6.3. Top-level element declaration</a></li><li><a href="#section_6.4">6.4. Top-level complex type definition</a></li><li><a href="#section_6.5">6.5. Top-level simple type definition</a></li><li><a href="#section_6.6">6.6. Element use within a complex type</a></li><li><a href="#section_6.7">6.7. Attribute use within a complex type</a></li></ul></li><li><a href="#section_7">7. XPath functions usable within XSLT 2.0 Schematron expressions</a><ul><li><a href="#section_7.1">7.1. Function <code>six:resolve</code></a></li></ul></li><li><a href="#appendix_A">Appendix A. References</a></li><li><a href="#appendix_B">Appendix B. Schema document for Schematron in XSD vocabulary (informative)</a></li><li><a href="#appendix_C">Appendix C. Index of Rules</a></li><li><a href="#appendix_D">Appendix D. Index of Definitions</a></li></ul></div><div class="section"><div class="heading"><a name="d3e29"></a>Abstract</div><div class="meta"><p>Add a real abstract</p></div><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam ultrices interdum tincidunt. Aliquam erat volutpat. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nulla ultricies ornare congue. Sed adipiscing elementum magna, vel fringilla orci vulputate ut.</p></div><div class="section"><div class="heading"><a name="section_1"></a>1. Introduction</div><div class="meta"><p>Add real introduction text</p></div><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam ultrices interdum tincidunt. Aliquam erat volutpat. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nulla ultricies ornare congue. Sed adipiscing elementum magna, vel fringilla orci vulputate ut.</p></div><div class="section"><div class="heading"><a name="section_2"></a>2. Problems and approaches</div><div class="section"><div class="heading"><a name="section_2.1"></a>2.1. Processing requirements</div><p>The Schematron specification <a href="#ref-sch" class="ref">[Schematron]</a> does not provide mechanisms for identifying if a Schematron document requires the support of the XPath 2.0 functions identified as supported only by a <a name="d3e73"></a><a href="#definition_schema-aware_XSLT_processor"><span class="termRef">schema-aware XSLT processor</span></a>.</p><p>This specification provides an attribute (<code>six:queryBinding</code>) that may indicate if a <a name="d3e82"></a><a href="#definition_schema-aware_XSLT_processor"><span class="termRef">schema-aware XSLT processor</span></a> is required.</p></div><div class="section"><div class="heading"><a name="section_2.2"></a>2.2. There is no definition of a basic or schema-aware XPath processor</div><p>As the distinction between a <a name="d3e94"></a><a href="#definition_schema-aware_XSLT_processor"><span class="termRef">schema-aware XSLT processor</span></a> and a <a name="d3e97"></a><a href="#definition_basic_XSLT_processor"><span class="termRef">basic XSLT processor</span></a> is defined by <a href="#ref-xslt2" class="ref">[XSLT 2.0]</a>, there is no clear definition of a basic XPath 2.0 processor that is not a <a name="d3e102"></a><a href="#definition_basic_XSLT_processor"><span class="termRef">basic XSLT processor</span></a>.</p><p>As a result, this specification does not include <q>xpath</q> or <q>xpath2</q> as options for the query binding, as their definitions would be ambiguous.</p></div><div class="section"><div class="heading"><a name="section_2.3"></a>2.3. Target Schematron processors vary</div><p>It is favorable for a Schematron assertion to be usable with a <a name="d3e123"></a><a href="#definition_basic_XSLT_processor"><span class="termRef">basic XSLT processor</span></a> as well as a <a name="d3e126"></a><a href="#definition_schema-aware_XSLT_processor"><span class="termRef">schema-aware XSLT processor</span></a>. In addition, it would be advantageous for a Schematron assertion to be usable with an XSLT 1.0 processor.</p><p>This specification provides attribute <code>six:queryBinding</code> to indicate what XSLT processor is required to process the Schematron. As well, it provides bare <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code> as <a name="d3e144"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> on some schema components. This allows assertions to be targeted to instances of a schema component processed with an XSLT 1.0 processor, an XSLT 2.0 <a name="d3e148"></a><a href="#definition_basic_XSLT_processor"><span class="termRef">basic XSLT processor</span></a>, or an XSLT 2.0 <a name="d3e151"></a><a href="#definition_schema-aware_XSLT_processor"><span class="termRef">schema-aware XSLT processor</span></a>.</p></div><div class="section"><div class="heading"><a name="section_2.4"></a>2.4. XML Schema has many features</div><p>Certain XML Schema mechanisms, including anonymous definition of types, local definitions of elements and attributes, and use of attribute groups and <code>xs:group</code> are difficult or impossible to express in an XPath expression that would apply Schematron assertions to any use of a schema document that used those mechanisms, within any arbitrary XML Schema. </p><p>Although these mechanisms have been ruled out of NIEM-conformant schemas, this specification does not require that an <a name="d3e169"></a><a href="#definition_schema_document_with_embedded_Schematron"><span class="termRef">schema document with embedded Schematron</span></a> is a NIEM-conformant schema. This specification does not do any extra work to provide extra facilities for mechanisms not used in NIEM-conformant schemas.</p></div><div class="section"><div class="heading"><a name="section_2.5"></a>2.5. Applying Schematron Rules to a schema component can be complex</div><p>A Schematron assertion embedded in a <a name="d3e182"></a><a href="#definition_schema_document"><span class="termRef">schema document</span></a> should be applied to any instance of an <a name="d3e185"></a><a href="#definition_XML_Schema"><span class="termRef">XML Schema</span></a> that uses that <a name="d3e188"></a><a href="#definition_schema_document"><span class="termRef">schema document</span></a>. Two methods to accomplish this are:</p><ol><li>use of schema-aware functions within the Schematron rule contexts, or</li><li>by schema analysis and use of resulting concrete element and attribute names in the Schematron rule contexts. </li></ol><p>For example, if an assertion should apply to any use of <code>nc:PersonType</code>, then a complete <a name="d3e208"></a><a href="#definition_XML_Schema"><span class="termRef">XML Schema</span></a> can be analyzed, and the complete list of elements of type <code>nc:PersonType</code> can be gathered. That list can be used in Schematron rule contexts, and the resultant Schematron document will be usable for that <a name="d3e214"></a><a href="#definition_XML_Schema"><span class="termRef">XML Schema</span></a>. Note that this can only be effectively done with a complete XML Schema, not a schema document. Method (2) can also be used for targeting XSLT 1.0 processors. </p><p>This specification provides for bare <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code> elements as <a name="d3e229"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> on schema components. It provides rules that enable platform-appropriate mechanisms to be applied, so that either method listed above may be used to define a Schematron document usable on the appropriate platform.</p></div><div class="section"><div class="heading"><a name="section_2.6"></a>2.6. Schematron namespace declarations are redundant to XML namespace declarations</div><p>Schematron defines its own mechanism for binding namespace prefixes to namespace URIs. The naive approach, of simply scraping embedded Schematron into a separate Schematron file, would mean that most namespace declarations must be defined twice, once at the XML / XML Schema level via an XML namespace declaration, and again for Schematron.</p><p>This specification provides for a single method of defining namespaces, using the XML Schema-standard method: XML namespace declarations. It further requires that namespace declarations appear only on the schema document's document element, so that they are easy to access and that the document does not include redefinitions of a namespace prefix at different points in the document, which is not reproducible in a Schematron document.</p></div></div><div class="section"><div class="heading"><a name="sec-declare-prefixes"></a><a name="section_3"></a>3. Namespace prefixes used in this document</div><ul><li>sch: <code>http://purl.oclc.org/dsdl/schematron</code></li><li>six: <code>http://release.niem.gov/niem/sch-in-xsd/1.0/</code></li><li>xs: <code>http://www.w3.org/2001/XMLSchema</code></li><li>xsl: <code>http://www.w3.org/1999/XSL/Transform</code></li><li>structures: <code>http://release.niem.gov/niem/structures/3.0/</code></li></ul></div><div class="section"><div class="heading"><a name="section_4"></a>4. Terminology established by references </div><div class="section"><div class="heading"><a name="section_4.1"></a>4.1. RFC 2119</div><div class="meta"><p>Add usual RFC 2119 template here</p></div><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam ultrices interdum tincidunt. Aliquam erat volutpat. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nulla ultricies ornare congue. Sed adipiscing elementum magna, vel fringilla orci vulputate ut.</p></div><div class="section"><div class="heading"><a name="section_4.2"></a>4.2. XML</div><p>This specification uses terminology from <a href="#ref-xml" class="ref">[XML]</a> to describe parts of XML documents. Terms used include:</p><ul><li><em>XML document</em>, as defined by <a href="#ref-xml" class="ref">[XML]</a> <a target="_blank" href="http://www.w3.org/TR/2008/REC-xml-20081126/#dt-xml-doc">Section 2, <em>Documents</em></a></li><li><em>element</em>, as defined by <a href="#ref-xml" class="ref">[XML]</a> <a target="_blank" href="http://www.w3.org/TR/2008/REC-xml-20081126/#dt-element">Section 3, <em>Logical Structures</em></a></li><li><em>attribute</em>, as described by <a href="#ref-xml" class="ref">[XML]</a> <a target="_blank" href="http://www.w3.org/TR/2008/REC-xml-20081126/#dt-attr">Section 3.1, <em>Start-Tags, End-Tags, and Empty-Element Tags</em></a></li></ul></div><div class="section"><div class="heading"><a name="section_4.3"></a>4.3. XML Information Set</div><p><a href="#ref-infoset" class="ref">[InfoSet]</a> defines terms and properties that describe the values of and relationships between parts of an XML document. This document uses this terminology to refer to content of XML documents. Terminology used includes:</p><ul><li><p>Properties of a document, as defined by <a href="#ref-infoset" class="ref">[InfoSet]</a> <a target="_blank" href="http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#infoitem.document">Section 2.1, <em>The Document Information Item</em></a>:</p><ul><li><em>[document element]</em></li></ul></li><li><p>Properties of an element, as defined by <a href="#ref-infoset" class="ref">[InfoSet]</a> <a target="_blank" href="http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#infoitem.element">Section 2.2, <em>Element Information Items</em></a>:</p><ul><li><em>[parent]</em></li><li><em>[children]</em></li><li><em>[attributes]</em></li></ul></li><li><p>Properties of an attribute, as defined by <a href="#ref-infoset" class="ref">[InfoSet]</a> <a target="_blank" href="http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#infoitem.attribute">Section 2.3, <em>Attribute Information Items</em></a>:</p><ul><li><em>[owner element]</em></li></ul></li></ul></div><div class="section"><div class="heading"><a name="section_4.4"></a>4.4. XML Schema</div><div class="box"><div class="normativeHead"><a name="definition_XML_Schema_definition_language"></a>[Definition: <dfn>XML Schema definition language</dfn>]</div><div class="sub"><p>The term <q>XML Schema definition language</q> is as defined by <a href="#ref-xsd1" class="ref">[XML Schema Structures]</a> <a target="_blank" href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/#abstract">Section , <em>Abstract</em></a>, which states:</p><blockquote><p>XML Schema: Structures specifies the XML Schema definition language, which offers facilities for describing the structure and constraining the contents of XML 1.0 documents, including those which exploit the XML Namespace facility. The schema language, which is itself represented in XML 1.0 and uses namespaces, substantially reconstructs and considerably extends the capabilities found in XML 1.0 document type definitions (DTDs).</p></blockquote></div></div><div class="box"><div class="normativeHead"><a name="definition_schema_document"></a>[Definition: <dfn>schema document</dfn>]</div><div class="sub"><p>The term <q>schema document</q> is as defined by <a href="#ref-xsd1" class="ref">[XML Schema Structures]</a> <a target="_blank" href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/#key-schemaDoc">Section 3.1.2, <em>XML Representations of Components</em></a>, which states:</p><blockquote><p>A document in this form (i.e. a &lt;schema&gt; element information item) is a <strong>schema document</strong>.</p></blockquote></div></div><div class="box"><div class="normativeHead"><a name="definition_XML_Schema"></a>[Definition: <dfn>XML Schema</dfn>]</div><div class="sub"><p>The term <q>XML Schema</q> is as defined by <a href="#ref-xsd1" class="ref">[XML Schema Structures]</a> <a target="_blank" href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/#key-schema">Section 2.2, <em>XML Schema Abstract Data Model</em></a>, which states:</p><blockquote><p>An <strong>XML Schema</strong> is a set of schema components.</p></blockquote></div></div></div><div class="section"><div class="heading"><a name="section_4.5"></a>4.5. XPath</div></div><div class="section"><div class="heading"><a name="section_4.6"></a>4.6. XSLT 2.0</div><div class="meta"><p>Add intro to this section</p></div><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam ultrices interdum tincidunt. Aliquam erat volutpat. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nulla ultricies ornare congue. Sed adipiscing elementum magna, vel fringilla orci vulputate ut.</p><div class="box"><div class="normativeHead"><a name="definition_schema-aware_XSLT_processor"></a>[Definition: <dfn>schema-aware XSLT processor</dfn>]</div><div class="sub"><p>The term <q>schema-aware XSLT processor</q> is as defined by <a href="#ref-xslt2" class="ref">[XSLT 2.0]</a> <a target="_blank" href="http://www.w3.org/TR/2007/REC-xslt20-20070123/#dt-schema-aware-xslt-processor">Section 21.2, <em>Schema-Aware XSLT Processor</em></a>, which states:</p><blockquote><p>A schema-aware XSLT processor is an XSLT processor that implements all the mandatory requirements of this specification, including those features that a basic XSLT processor signals as an error.</p></blockquote></div></div><div class="box"><div class="normativeHead"><a name="definition_basic_XSLT_processor"></a>[Definition: <dfn>basic XSLT processor</dfn>]</div><div class="sub"><p>The term <q>basic XSLT processor</q> is as defined by <a href="#ref-xslt2" class="ref">[XSLT 2.0]</a> <a target="_blank" href="http://www.w3.org/TR/2007/REC-xslt20-20070123/#dt-basic-xslt-processor">Section 21.1, <em>Basic XSLT Processor</em></a>, which states:</p><blockquote><p>A basic XSLT processor is an XSLT processor that implements all the mandatory requirements of this specification with the exception of certain explicitly-identified constructs related to schema processing.</p></blockquote></div></div></div><div class="section"><div class="heading"><a name="section_4.7"></a>4.7. XSLT 1.0</div><div class="meta"><p>Add an introduction</p></div><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam ultrices interdum tincidunt. Aliquam erat volutpat. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Nulla ultricies ornare congue. Sed adipiscing elementum magna, vel fringilla orci vulputate ut.</p></div><div class="section"><div class="heading"><a name="section_4.8"></a>4.8. Schematron</div><p>The Schematron specification <a href="#ref-sch" class="ref">[Schematron]</a> coins and uses the term <q>Query Language Binding</q> to refer to the framework that defines the syntax of queries (e.g., <code>test</code> and <code>select</code>) and the types of the results of queries made by a Schematron file. Relevant sections include Section 6.4, <em>Query Language Binding</em>, and Annex C, <em>Default Query Language Binding</em>.</p></div><div class="section"><div class="heading"><a name="section_4.9"></a>4.9. NIEM Conformance Target Attribute Specification</div><p>This specification uses terms from <a href="#ref-ctas" class="ref">[CTAS]</a>, including:</p><ul><li><em>conformant document</em>, as defined by <a href="#ref-ctas" class="ref">[CTAS]</a> <a target="_blank" href="http://reference.niem.gov/niem/specification/conformance-targets-attribute/3.0/NIEM-CTAS-3.0-2014-07-31.html#definition_conformant_document">Section 3.2, <em>Conformance to this Specification</em></a>.</li><li><em>effective conformance target identifier</em>, as defined by <a href="#ref-ctas" class="ref">[CTAS]</a> <a target="_blank" href="http://reference.niem.gov/niem/specification/conformance-targets-attribute/3.0/NIEM-CTAS-3.0-2014-07-31.html#definition_effective_conformance_target_identifier">Section 4, <em>Semantics and Use</em></a>.</li></ul></div><div class="section"><div class="heading"><a name="section_4.10"></a>4.10. NIEM Naming and Design Rules</div></div></div><div class="section"><div class="heading"><a name="section_5"></a>5. Terms and Definitions</div><div class="box"><div class="normativeHead"><a name="definition_schema_document_with_embedded_Schematron"></a>[Definition: <dfn>schema document with embedded Schematron</dfn>]</div><div class="sub"><div class="meta"><p>Add a real definition.</p></div><p>Conformance target identifier: <q>http://reference.niem.gov/niem/specification/sch-in-xsd/1.0/#XSDWithEmbeddedSchematron</q>.</p><p>This conformance target uses the conformance target code <q><a name="conformance_target_ct-xsd"></a>XSD+SCH</q></p></div></div><div class="box"><div class="normativeHead"><a name="definition_implied_Schematron_document"></a>[Definition: <dfn>implied Schematron document</dfn>]</div><div class="sub"><div class="meta"><p>Figure out applicability of rules that define an implied Schematron document. Do they <em>apply</em> to the implied schematron document?</p></div><p>An <em>implied Schematron document</em> of an <a name="d3e716"></a><a href="#definition_schema_document_with_embedded_Schematron"><span class="termRef">schema document with embedded Schematron</span></a> is a Schematron document that is produced by conformant processing of a <a name="d3e719"></a><a href="#definition_schema_document_with_embedded_Schematron"><span class="termRef">schema document with embedded Schematron</span></a>.</p></div></div><div class="box"><div class="normativeHead"><a name="definition_application_information"></a>[Definition: <dfn>application information</dfn>]</div><div class="sub"><p>An <a name="d3e728"></a><a href="#definition_XML_Schema_definition_language"><span class="termRef">XML Schema definition language</span></a> element <var>$element</var> that defines an XML Schema component has <em>application information</em> of an element <var>$info-element</var> if and only if element <var>$info-element</var> has [parent] element <code>xs:appinfo</code> with <strong>[parent]</strong> element <code>xs:annotation</code> with <strong>[parent]</strong> element <var>$element</var>.</p><p>An <a name="d3e762"></a><a href="#definition_XML_Schema_definition_language"><span class="termRef">XML Schema definition language</span></a> element <var>$element</var> that defines an XML Schema component has <em>application information</em> of an attribute <var>$info-attribute</var> if and only if attribute <var>$info-attribute</var> has [owner element] <var>$element</var>.</p></div></div></div><div class="section"><div class="heading"><a name="section_6"></a>6. Rules</div><div class="rule-section"><div class="heading"><a name="rule_6-1"></a>Rule 6-1. Document is an XML Schema document</div><div class="box"><div class="normativeHead">[Rule 6-1] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>The document MUST be a <a name="d3e798"></a><a href="#definition_schema_document"><span class="termRef">schema document</span></a>.</p></div></div><div class="rule-section"><div class="heading"><a name="rule_6-2"></a>Rule 6-2. XML Schema elements do not appear as application information</div><div class="box"><div class="normativeHead">[Rule 6-2] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><pre>&lt;sch:pattern&gt;
  &lt;sch:rule context="xs:*"&gt;
    &lt;sch:assert test="empty(ancestor::xs:appinfo)"
                &gt;An XML Schema element must not appear as a descendant of an element xs:appinfo&lt;/sch:assert&gt;
  &lt;/sch:rule&gt;
&lt;/sch:pattern&gt;</pre></div></div><div class="rule-section"><div class="heading"><a name="rule_6-3"></a>Rule 6-3. Document conforms to Conformance Targets Attribute Specification</div><div class="box"><div class="normativeHead">[Rule 6-3] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>The document MUST be a conformant document, as defined by <a href="#ref-ctas" class="ref">[CTAS]</a>.</p></div></div><div class="rule-section"><div class="heading"><a name="rule_6-4"></a>Rule 6-4. Document has effective conformance target identifier</div><div class="box"><div class="normativeHead">[Rule 6-4] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><pre>&lt;sch:pattern&gt;
  &lt;sch:rule context="/xs:schema"&gt;
    &lt;sch:assert test="some $conformance-target 
                      in tokenize(normalize-space( (.//@ct:conformanceTargets)[1] ))
                      satisfies $conformance-target = 'http://reference.niem.gov/niem/specification/sch-in-xsd/1.0/#XSDWithEmbeddedSchematron'"
        &gt;The document MUST have an effective conformance target identifier "http://reference.niem.gov/niem/specification/sch-in-xsd/1.0/#XSDWithEmbeddedSchematron".&lt;/sch:assert&gt;
  &lt;/sch:rule&gt;
&lt;/sch:pattern&gt;</pre></div></div><div class="rule-section"><div class="heading"><a name="rule_6-5"></a>Rule 6-5. Attribute <code>six:queryBinding</code> owner element is <code>xs:schema</code></div><div class="box"><div class="normativeHead">[Rule 6-5] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><pre>&lt;sch:pattern&gt;
   &lt;sch:rule context="*/@six:queryBinding"&gt;
     &lt;sch:assert test="node-name() = xs:QName('xs:schema')"
         &gt;Attribute six:queryBinding MUST have [owner element] xs:schema&lt;/sch:assert&gt;
   &lt;/sch:rule&gt;
&lt;/sch:pattern&gt;</pre></div></div><div class="rule-section"><div class="heading"><a name="rule_6-6"></a>Rule 6-6. Schema element has query binding</div><div class="box"><div class="normativeHead">[Rule 6-6] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><pre>&lt;sch:pattern&gt;
   &lt;sch:rule context="/xs:schema"&gt;
     &lt;sch:assert test="@six:queryBinding"
         &gt;Document element xs:schema MUST have attribute six:queryBinding&lt;/sch:assert&gt;
   &lt;/sch:rule&gt;
&lt;/sch:pattern&gt;</pre></div></div><div class="rule-section"><div class="heading"><a name="r-query-binding-indicates-query-lang"></a><a name="rule_6-7"></a>Rule 6-7. Attribute <code>six:queryBinding</code> identifies query language</div><div class="box"><div class="normativeHead">[Rule 6-7] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><pre>&lt;sch:pattern&gt;
  &lt;sch:rule context="*/@six:queryBinding"&gt;
    &lt;sch:assert test="@six:queryBinding = ('xslt1', 'xslt2-basic', 'xslt2-sa')"
        &gt;Attribute six:queryBinding must indicate query language binding.&lt;/sch:assert&gt;
  &lt;/sch:rule&gt;
&lt;/sch:pattern&gt;</pre></div></div><div class="meta"><p>What's the applicability for an interpretation rule for the implied schematron document?</p></div><div class="rule-section"><div class="heading"><a name="rule_6-8"></a>Rule 6-8. Attribute <code>six:queryBinding</code> sets processing expectations</div><div class="box"><div class="normativeHead">[Rule 6-8] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Interpretation)</div><p>The application information attribute <code>six:queryBinding</code> on a <a name="d3e958"></a><a href="#definition_schema_document_with_embedded_Schematron"><span class="termRef">schema document with embedded Schematron</span></a> MUST be interpreted as follows:</p><ul><li><p><q>xslt1</q>:</p><p>The <a name="d3e973"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> requires processing by an XSLT 1.0 processor.</p><p>The <a name="d3e979"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> MUST have an attribute <code>queryBinding</code> on the document element with a value of <q>xslt</q>.</p></li><li><p><q>xslt2-basic</q>:</p><p>The <a name="d3e999"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> requires processing by either a <a name="d3e1002"></a><a href="#definition_basic_XSLT_processor"><span class="termRef">basic XSLT processor</span></a> or a <a name="d3e1005"></a><a href="#definition_schema-aware_XSLT_processor"><span class="termRef">schema-aware XSLT processor</span></a>.</p><p>The <a name="d3e1011"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> MUST have an attribute <code>queryBinding</code> on the document element with a value of <q>xslt2</q>.</p></li><li><p><q>xslt2-sa</q>:</p><p>The <a name="d3e1031"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> requires processing by a <a name="d3e1034"></a><a href="#definition_schema-aware_XSLT_processor"><span class="termRef">schema-aware XSLT processor</span></a>.</p><p>The <a name="d3e1040"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> MUST have an attribute <code>queryBinding</code> on the document element with a value of <q>xslt2</q>.</p></li></ul></div><p>There is no query language binding defined by <a href="#ref-sch" class="ref">[Schematron]</a> that indicates schema-aware processing versus basic processing. The schema-aware and basic XSLT processors are defined by <a href="#ref-xslt2" class="ref">[XSLT 2.0]</a>, not by <a href="#ref-xpath2" class="ref">[XPath 2.0]</a>, so there is no normative source for how to process a Schematron document with query language binding of <q>xpath2</q>.</p></div><div class="rule-section"><div class="heading"><a name="rule_6-9"></a>Rule 6-9. Namespace prefixes declared only on the document element</div><div class="box"><div class="normativeHead">[Rule 6-9] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><pre>&lt;sch:pattern&gt;
  &lt;sch:rule context="*[not(self::* is root(.))]"&gt;
    &lt;sch:assert test="for $element in .,
                          $parent in parent::* return (
                        (every $prefix 
                         in in-scope-prefixes($element)
                         satisfies (
                           $prefix = in-scope-prefixes($parent)
                           and namespace-uri-for-prefix($prefix, $element) 
                               = namespace-uri-for-prefix($prefix, $parent)))
                        and every $prefix
                            in in-scope-prefixes($parent)
                            satisfies $prefix = in-scope-prefixes($element))"
        &gt;The document MUST NOT have a namespace prefix definition on any element that is not the document element.&lt;/sch:assert&gt;
  &lt;/sch:rule&gt;
&lt;/sch:pattern&gt;            </pre></div></div><div class="meta"><p>Do this via schematron</p></div><div class="rule-section"><div class="heading"><a name="rule_6-10"></a>Rule 6-10. No use of <code>sch:ns</code></div><div class="box"><div class="normativeHead">[Rule 6-10] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>A component of a <a name="d3e1104"></a><a href="#definition_schema_document_with_embedded_Schematron"><span class="termRef">schema document with embedded Schematron</span></a> MUST NOT have <a name="d3e1107"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> that is an element <code>sch:ns</code>.</p></div><p>All namespace declarations in the implied Schematron document are originated from the namespace declarations appearing on the document element <code>xs:schema</code>.</p></div><div class="meta"><p>Are there exceptions to this? Specific namespaces that will NEVER appear as a <code>sch:ns</code>?</p></div><div class="rule-section"><div class="heading"><a name="rule_6-11"></a>Rule 6-11. Implied Schematron document has <code>sch:ns</code></div><div class="box"><div class="normativeHead">[Rule 6-11] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Interpretation)</div><p>The <a name="d3e1140"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> of <a name="d3e1143"></a><a href="#definition_schema_document_with_embedded_Schematron"><span class="termRef">schema document with embedded Schematron</span></a> <var>$document</var> MUST have a <code>sch:ns</code> element corresponding to each namespace declaration that occurs on the [document element] of <var>$document</var>.</p></div></div><div class="section"><div class="heading"><a name="section_6.1"></a>6.1. Schematron throughout the document</div><div class="meta"><p>What defines <q>document order</q>?</p></div><div class="rule-section"><div class="heading"><a name="rule_6-12"></a>Rule 6-12. Implied Schematron document contains application information from document</div><div class="box"><div class="normativeHead">[Rule 6-12] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Interpretation)</div><p>The <a name="d3e1181"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> of <a name="d3e1184"></a><a href="#definition_schema_document_with_embedded_Schematron"><span class="termRef">schema document with embedded Schematron</span></a> <var>$document</var> MUST contain, preserving document order, content corresponding to:</p><ul><li>element application information of the [document element] <code>xs:schema</code> of <var>$document</var> that has the namespace corresponding to the prefixes <q>sch</q> and <q>xsl</q>,</li><li>element <a name="d3e1212"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> of any element <code>sch:pattern</code> within <var>$document</var>, and</li><li>other corresponding content of an <a name="d3e1225"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a>, as defined by this specification.</li></ul></div><p>Note that the namespace prefixes <q>sch</q> and <q>xsl</q> are defined for this document in <a href="#section_3">Section 3, <em>Namespace prefixes used in this document</em>, above</a>.</p></div><div class="rule-section"><div class="heading"><a name="rule_6-13"></a>Rule 6-13. Application information corresponds to a valid Schematron document</div><div class="box"><div class="normativeHead">[Rule 6-13] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>The document MUST NOT contain any annotations from the <q>sch</q> or <q>xsl</q> namespaces that would result in an invalid <a name="d3e1258"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a>.</p></div></div><div class="meta"><p>This rule is convoluted; refine.</p></div><div class="rule-section"><div class="heading"><a name="rule_6-14"></a>Rule 6-14. Schema component definitionshave limited Schematron content</div><div class="box"><div class="normativeHead">[Rule 6-14] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>Elements other than <code>xs:schema</code> MUST NOT have <a name="d3e1281"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> in the <q>sch</q> namespace other than:</p><ul><li>Any element with the namespace corresponding to the prefix <q>xs</q> MAY have <a name="d3e1296"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> <code>sch:pattern</code>.</li><li>Other XML Schema component-defining elements MAY have specific application information in the namespace corresponding to the prefix <q>sch</q> only as explicitly allowed by other rules in this specification.</li></ul></div></div></div><div class="section"><div class="heading"><a name="section_6.2"></a>6.2. Top-level attribute declaration</div><div class="rule-section"><div class="heading"><a name="rule_6-15"></a>Rule 6-15. Schematron application information allowed on top-level attribute declaration</div><div class="box"><div class="normativeHead">[Rule 6-15] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>An element <code>xs:attribute</code> with [parent] element <code>xs:schema</code> MAY have have application information elements <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>.</p></div></div><div class="rule-section"><div class="heading"><a name="rule_6-16"></a>Rule 6-16. Application information of top-level attribute declaration entails pattern</div><div class="box"><div class="normativeHead">[Rule 6-16] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Interpretation)</div><p>The content in an <a name="d3e1355"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> corresponding to occurrences of elements <code>sch:let</code>, <code>sch:assert</code>, or <code>sch:report</code> as <a name="d3e1367"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> of an element <code>xs:attribute</code> with [parent] element <code>xs:schema</code> corresponds to an occurrence of element <code>sch:pattern</code> with [children] containing an element <code>sch:rule</code>, with context that applies to any element with [attributes] containing that attribute. This <code>sch:rule</code> has [children] containing elements that correspond to the elements <code>sch:let</code>, <code>sch:assert</code>, or <code>sch:report</code>, preserving document order.</p></div></div></div><div class="section"><div class="heading"><a name="section_6.3"></a>6.3. Top-level element declaration</div><div class="rule-section"><div class="heading"><a name="rule_6-17"></a>Rule 6-17. Schematron application information allowed on top-level element declaration</div><div class="box"><div class="normativeHead">[Rule 6-17] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>An element <code>xs:element</code> with [parent] element <code>xs:schema</code> MAY have have <a name="d3e1421"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> elements <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>.</p></div></div><div class="rule-section"><div class="heading"><a name="rule_6-18"></a>Rule 6-18. Application information of top-level element declaration entails pattern</div><div class="box"><div class="normativeHead">[Rule 6-18] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Interpretation)</div><p>The content in an <a name="d3e1446"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> corresponding to occurrences of <code>sch:let</code>, <code>sch:assert</code>, or <code>sch:report</code> on an element <code>xs:element</code> with [parent] element <code>xs:schema</code> corresponds to an occurrence of element <code>sch:pattern</code> with child element <code>sch:rule</code>, with context that applies to any occurrence of that element, or an element in the substitution group of that element. This <code>sch:rule</code> has [children] containing elements corresponding to <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>, preserving document order.</p></div></div></div><div class="section"><div class="heading"><a name="section_6.4"></a>6.4. Top-level complex type definition</div><div class="rule-section"><div class="heading"><a name="rule_6-19"></a>Rule 6-19. Schematron application information allowed on top-level complex type definition</div><div class="box"><div class="normativeHead">[Rule 6-19] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>An element <code>xs:complexType</code> with [parent] element <code>xs:schema</code> MAY have have application information elements <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>.</p></div></div><div class="rule-section"><div class="heading"><a name="rule_6-20"></a>Rule 6-20. Application information of top-level complex type definition entails pattern</div><div class="box"><div class="normativeHead">[Rule 6-20] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Interpretation)</div><p>The content in an <a name="d3e1529"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> corresponding to occurrences of <code>sch:let</code>, <code>sch:assert</code>, or <code>sch:report</code> on an element <code>xs:complexType</code> with [parent] element <code>xs:schema</code> corresponds to an occurrence of element <code>sch:pattern</code> with child element <code>sch:rule</code>, with context that applies to any occurrence of an element that is of that type, or is of a type derived from that type. This <code>sch:rule</code> has children of corresponding to <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>, preserving document order.</p></div></div></div><div class="section"><div class="heading"><a name="section_6.5"></a>6.5. Top-level simple type definition</div><div class="rule-section"><div class="heading"><a name="rule_6-21"></a>Rule 6-21. Schematron application information allowed on top-level simple type definition</div><div class="box"><div class="normativeHead">[Rule 6-21] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>An element <code>xs:simpleType</code> with [parent] element <code>xs:schema</code> MAY have have application information elements <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>.</p></div></div><div class="rule-section"><div class="heading"><a name="rule_6-22"></a>Rule 6-22. Application information of top-level simple type definition entails patterns</div><div class="box"><div class="normativeHead">[Rule 6-22] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Interpretation)</div><p>The content in an <a name="d3e1612"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> corresponding to a set of occurrences of <code>sch:let</code>, <code>sch:assert</code>, or <code>sch:report</code> on an element <code>xs:simpleType</code> with [parent] element <code>xs:schema</code> corresponds to zero or more occurrence of element <code>sch:pattern</code>, each with [children] containing element <code>sch:rule</code>, with <code>context</code> that applies to any occurrence of an element that is of that type, or is of a type derived from that type. This <code>sch:rule</code> establishes a variable <var>$six:value</var> that has a value of the instance content that is of the simple type. This <code>sch:rule</code> has subsequent element children of corresponding to the <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code> from the document, preserving document order. </p></div><p>Simple type definitions are particularly tricky, in that Schematron processors generally do not support rule context on specific simple content; contexts on text nodes or attribute values will yield errors and warnings. For this reason, simple content values need a level of redirection; a separate Schematron <code>sch:pattern</code> may be established for each element of a simple type, each element with simple content of a simple type, or each attribute of a simple type. Each of these is defined as needed; multiple patterns will primarily be needed when schema-aware XSLT is not the target of the generated Schematron document.</p></div></div><div class="section"><div class="heading"><a name="section_6.6"></a>6.6. Element use within a complex type</div><div class="rule-section"><div class="heading"><a name="rule_6-23"></a>Rule 6-23. Schematron application information allowed on element use in a top-level complex type definition</div><div class="box"><div class="normativeHead">[Rule 6-23] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>An element matching the XPath expression</p><div class="sub"><pre>/xs:schema/xs:complexType//xs:element[@ref]</pre></div><p>MAY have have application information elements <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>.</p></div></div><div class="rule-section"><div class="heading"><a name="rule_6-24"></a>Rule 6-24. Application information of element use in top-level complex type definition entails pattern</div><div class="box"><div class="normativeHead">[Rule 6-24] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Interpretation)</div><p>Content of a <a name="d3e1713"></a><a href="#definition_schema_document_with_embedded_Schematron"><span class="termRef">schema document with embedded Schematron</span></a> corresponding to the elements <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code> that are <a name="d3e1725"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> on an element matching the XPath expression:</p><div class="sub"><pre>/xs:schema/xs:complexType//xs:element[@ref]</pre></div><p>has corresponds to an <a name="d3e1737"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> with an occurrence of element <code>sch:pattern</code> with [children] containing element <code>sch:rule</code> with <code>context</code> that applies to any occurrence of the element identified by the <code>ref</code> attribute, or any element that may be substituted for that element, that occurs within any element that has the identified complex type, or a type derived from that complex type. This <code>sch:rule</code> has [children] elements corresponding to <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>, preserving document order.</p></div></div></div><div class="section"><div class="heading"><a name="section_6.7"></a>6.7. Attribute use within a complex type</div><div class="rule-section"><div class="heading"><a name="rule_6-25"></a>Rule 6-25. Schematron application information allowed on attribute use in top-level complex type definition</div><div class="box"><div class="normativeHead">[Rule 6-25] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Constraint)</div><p>An element matching the XPath expression</p><div class="sub"><pre>/xs:schema/xs:complexType//xs:attribute[@ref]</pre></div><p>MAY have have application information elements <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>.</p></div></div><div class="rule-section"><div class="heading"><a name="rule_6-26"></a>Rule 6-26. Application information of attribute use in top-level complex type definition entails pattern</div><div class="box"><div class="normativeHead">[Rule 6-26] (<a href="#conformance_target_ct-xsd">XSD+SCH</a>) (Interpretation)</div><p>Within a <a name="d3e1813"></a><a href="#definition_schema_document_with_embedded_Schematron"><span class="termRef">schema document with embedded Schematron</span></a>, elements <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code> that are <a name="d3e1825"></a><a href="#definition_application_information"><span class="termRef">application information</span></a> on an element matching the XPath expression:</p><div class="sub"><pre>/xs:schema/xs:complexType//xs:attribute[@ref]</pre></div><p>corresponds to a <a name="d3e1837"></a><a href="#definition_implied_Schematron_document"><span class="termRef">implied Schematron document</span></a> with an occurrence of element <code>sch:pattern</code> with [children] containing element <code>sch:rule</code> with attribute <code>context</code> that applies to any occurrence of an element that has the identified complex type, or a type derived from that complex type, that owns the attribute identified by the <code>ref</code> attribute. This <code>sch:rule</code> has [children] elements corresponding to elements <code>sch:let</code>, <code>sch:assert</code>, and <code>sch:report</code>, preserving document order.</p></div></div></div></div><div class="section"><div class="heading"><a name="section_7"></a>7. XPath functions usable within XSLT 2.0 Schematron expressions</div><div class="section"><div class="heading"><a name="section_7.1"></a>7.1. Function <code>six:resolve</code></div><p>The function <code>six:resolve</code> is designed to resolve NIEM reference elements to their targets, to simplify XPath expressions.</p><p>Function interface:</p><div class="sub"><pre>six:resolve($elements as element()*) as element()*</pre></div><p>The function <code>six:resolve</code> yields:</p><div class="sub"><p>If <var>$elements</var> is an <code>empty-sequence()</code>, then yield <code>'()'</code>, an empty sequence.</p><p>Otherwise, for each <var>$element</var> in sequence <var>$elements</var>, yield:</p><div class="sub"><p>If <var>$element</var> has attribute <code>structures:ref</code> <var>$ref</var>, yield:</p><div class="sub"><p>If there is an element <var>$target</var> with attribute <code>structures:id</code> with value <var>$ref</var>, then yield <var>$target</var></p><p>Otherwise, yield <code>'()'</code>, an empty sequence. It is RECOMMENDED that implementations indicate an error if this case occurs.</p></div><p>Otherwise, yield <var>$element</var>.</p></div></div></div></div><div class="meta"><p>Add entry for RFC 2119</p></div><div class="section"><div class="heading"><a name="appendix_A"></a>Appendix A. References</div><p class="hang"><a name="ref-ctas"></a><span class="ref">[CTAS]</span>: Roberts, Webb. <q>NIEM Conformance Targets Attribute Specification, Version 3.0.</q> NIEM Technical Architecture Committee, July 31, 2014. <a class="url" target="_blank" href="http://reference.niem.gov/niem/specification/conformance-targets-attribute/3.0/NIEM-CTAS-3.0-2014-07-31.html">http://reference.niem.gov/niem/specification/conformance-targets-attribute/3.0/NIEM-CTAS-3.0-2014-07-31.html</a>.</p><div class="sub"></div><p class="hang"><a name="ref-sch"></a><span class="ref">[Schematron]</span>: <q>ISO/IEC STANDARD 19757-3: Information Technology — Document Schema Definition Languages (DSDL) Part 3: Rule-Based Validation — Schematron.</q> ISO/IEC, June 1, 2006. <a class="url" target="_blank" href="http://standards.iso.org/ittf/PubliclyAvailableStandards/c040833_ISO_IEC_19757-3_2006(E).zip">http://standards.iso.org/ittf/PubliclyAvailableStandards/c040833_ISO_IEC_19757-3_2006(E).zip</a>.</p><div class="sub"></div><p class="hang"><a name="ref-xslt2"></a><span class="ref">[XSLT 2.0]</span>: Kay, Michael. <q>XSL Transformations (XSLT) Version 2.0.</q> W3C, January 23, 2007. <a class="url" target="_blank" href="http://www.w3.org/TR/2007/REC-xslt20-20070123/">http://www.w3.org/TR/2007/REC-xslt20-20070123/</a>.</p><div class="sub"></div><p class="hang"><a name="ref-xpath2"></a><span class="ref">[XPath 2.0]</span>: Berglund, Anders, Scott Boag, Don Chamberlin, Mary F. Fernández, Michael Kay, Jonathan Robie, and Jérôme Siméon. <q>XML Path Language (XPath) 2.0 (Second Edition).</q> W3C, January 3, 2011. <a class="url" target="_blank" href="http://www.w3.org/TR/2010/REC-xpath20-20101214/">http://www.w3.org/TR/2010/REC-xpath20-20101214/</a></p><div class="sub"></div><p class="hang"><a name="ref-xsd1"></a><span class="ref">[XML Schema Structures]</span>: <q>XML Schema Part 1: Structures Second Edition</q>, W3C Recommendation, 28 October 2004. Available from <a class="url" target="_blank" href="http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/">http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/</a>.</p><div class="sub"></div><p class="hang"><a name="ref-infoset"></a><span class="ref">[InfoSet]</span>: Cowan, John, and Richard Tobin. <q>XML Information Set (Second Edition),</q> February 4, 2004. <a class="url" target="_blank" href="http://www.w3.org/TR/2004/REC-xml-infoset-20040204/">http://www.w3.org/TR/2004/REC-xml-infoset-20040204/</a>.</p><div class="sub"></div><p class="hang"><a name="ref-xml"></a><span class="ref">[XML]</span>: Bray, Tim, Jean Paoli, C. M. Sperberg-McQueen, Eve Maler, and François Yergeau. <q>Extensible Markup Language (XML) 1.0 (Fifth Edition).</q> The World Wide Web Consortium (W3C), November 26, 2008. <a class="url" target="_blank" href="http://www.w3.org/TR/2008/REC-xml-20081126/">http://www.w3.org/TR/2008/REC-xml-20081126/</a>.</p><div class="sub"></div></div><div class="section"><div class="heading"><a name="appendix_B"></a>Appendix B. Schema document for Schematron in XSD vocabulary (informative)</div><p>This schema document is provided to support the user, but is not considered normative. The syntax of <code>six:queryBinding</code> is provided via <a href="#rule_6-7">Rule 6-7, <em>Attribute <code>six:queryBinding</code> identifies query language</em> (XSD+SCH), above</a>.</p><pre>&lt;?xml version="1.0" encoding="us-ascii"?&gt;
&lt;schema targetNamespace="http://release.niem.gov/niem/sch-in-xsd/1.0/"
        xmlns="http://www.w3.org/2001/XMLSchema"&gt;
  &lt;annotation&gt;
    &lt;documentation&gt;This is a schema for a vocabulary for use by XML Schema
      documents that conform to "Embedding Schematron in XML Schema Documents",
      version 1.0.&lt;/documentation&gt;
  &lt;/annotation&gt;
  
  &lt;attribute name="queryBinding"&gt;
    &lt;simpleType&gt;
      &lt;enumeration value="xslt1"/&gt;
      &lt;enumeration value="xslt2-basic"/&gt;
      &lt;enumeration value="xslt2-sa"/&gt;
    &lt;/simpleType&gt;
  &lt;/attribute&gt;
  
&lt;/schema&gt;
</pre></div><div class="section"><div class="heading"><a name="appendix_C"></a>Appendix C. Index of Rules</div><ul><li><a href="#rule_6-1">Rule 6-1, <em>Document is an XML Schema document</em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-2">Rule 6-2, <em>XML Schema elements do not appear as application information</em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-3">Rule 6-3, <em>Document conforms to Conformance Targets Attribute Specification</em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-4">Rule 6-4, <em>Document has effective conformance target identifier</em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-5">Rule 6-5, <em>Attribute <code>six:queryBinding</code> owner element is <code>xs:schema</code></em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-6">Rule 6-6, <em>Schema element has query binding</em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-7">Rule 6-7, <em>Attribute <code>six:queryBinding</code> identifies query language</em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-8">Rule 6-8, <em>Attribute <code>six:queryBinding</code> sets processing expectations</em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-9">Rule 6-9, <em>Namespace prefixes declared only on the document element</em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-10">Rule 6-10, <em>No use of <code>sch:ns</code></em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-11">Rule 6-11, <em>Implied Schematron document has <code>sch:ns</code></em> (XSD+SCH)</a>: <a href="#section_6">Section 6, <em>Rules</em></a></li><li><a href="#rule_6-12">Rule 6-12, <em>Implied Schematron document contains application information from document</em> (XSD+SCH)</a>: <a href="#section_6.1">Section 6.1, <em>Schematron throughout the document</em></a></li><li><a href="#rule_6-13">Rule 6-13, <em>Application information corresponds to a valid Schematron document</em> (XSD+SCH)</a>: <a href="#section_6.1">Section 6.1, <em>Schematron throughout the document</em></a></li><li><a href="#rule_6-14">Rule 6-14, <em>Schema component definitionshave limited Schematron content</em> (XSD+SCH)</a>: <a href="#section_6.1">Section 6.1, <em>Schematron throughout the document</em></a></li><li><a href="#rule_6-15">Rule 6-15, <em>Schematron application information allowed on top-level attribute declaration</em> (XSD+SCH)</a>: <a href="#section_6.2">Section 6.2, <em>Top-level attribute declaration</em></a></li><li><a href="#rule_6-16">Rule 6-16, <em>Application information of top-level attribute declaration entails pattern</em> (XSD+SCH)</a>: <a href="#section_6.2">Section 6.2, <em>Top-level attribute declaration</em></a></li><li><a href="#rule_6-17">Rule 6-17, <em>Schematron application information allowed on top-level element declaration</em> (XSD+SCH)</a>: <a href="#section_6.3">Section 6.3, <em>Top-level element declaration</em></a></li><li><a href="#rule_6-18">Rule 6-18, <em>Application information of top-level element declaration entails pattern</em> (XSD+SCH)</a>: <a href="#section_6.3">Section 6.3, <em>Top-level element declaration</em></a></li><li><a href="#rule_6-19">Rule 6-19, <em>Schematron application information allowed on top-level complex type definition</em> (XSD+SCH)</a>: <a href="#section_6.4">Section 6.4, <em>Top-level complex type definition</em></a></li><li><a href="#rule_6-20">Rule 6-20, <em>Application information of top-level complex type definition entails pattern</em> (XSD+SCH)</a>: <a href="#section_6.4">Section 6.4, <em>Top-level complex type definition</em></a></li><li><a href="#rule_6-21">Rule 6-21, <em>Schematron application information allowed on top-level simple type definition</em> (XSD+SCH)</a>: <a href="#section_6.5">Section 6.5, <em>Top-level simple type definition</em></a></li><li><a href="#rule_6-22">Rule 6-22, <em>Application information of top-level simple type definition entails patterns</em> (XSD+SCH)</a>: <a href="#section_6.5">Section 6.5, <em>Top-level simple type definition</em></a></li><li><a href="#rule_6-23">Rule 6-23, <em>Schematron application information allowed on element use in a top-level complex type definition</em> (XSD+SCH)</a>: <a href="#section_6.6">Section 6.6, <em>Element use within a complex type</em></a></li><li><a href="#rule_6-24">Rule 6-24, <em>Application information of element use in top-level complex type definition entails pattern</em> (XSD+SCH)</a>: <a href="#section_6.6">Section 6.6, <em>Element use within a complex type</em></a></li><li><a href="#rule_6-25">Rule 6-25, <em>Schematron application information allowed on attribute use in top-level complex type definition</em> (XSD+SCH)</a>: <a href="#section_6.7">Section 6.7, <em>Attribute use within a complex type</em></a></li><li><a href="#rule_6-26">Rule 6-26, <em>Application information of attribute use in top-level complex type definition entails pattern</em> (XSD+SCH)</a>: <a href="#section_6.7">Section 6.7, <em>Attribute use within a complex type</em></a></li></ul></div><div class="section"><div class="heading"><a name="appendix_D"></a>Appendix D. Index of Definitions</div><ul><li><a href="#definition_application_information">application information</a>: <a href="#section_5">Section 5, <em>Terms and Definitions</em></a></li><li><a href="#definition_basic_XSLT_processor">basic XSLT processor</a>: <a href="#section_4.6">Section 4.6, <em>XSLT 2.0</em></a></li><li><a href="#definition_implied_Schematron_document">implied Schematron document</a>: <a href="#section_5">Section 5, <em>Terms and Definitions</em></a></li><li><a href="#definition_schema_document">schema document</a>: <a href="#section_4.4">Section 4.4, <em>XML Schema</em></a></li><li><a href="#definition_schema_document_with_embedded_Schematron">schema document with embedded Schematron</a>: <a href="#section_5">Section 5, <em>Terms and Definitions</em></a></li><li><a href="#definition_schema-aware_XSLT_processor">schema-aware XSLT processor</a>: <a href="#section_4.6">Section 4.6, <em>XSLT 2.0</em></a></li><li><a href="#definition_XML_Schema">XML Schema</a>: <a href="#section_4.4">Section 4.4, <em>XML Schema</em></a></li><li><a href="#definition_XML_Schema_definition_language">XML Schema definition language</a>: <a href="#section_4.4">Section 4.4, <em>XML Schema</em></a></li></ul></div></body></html>